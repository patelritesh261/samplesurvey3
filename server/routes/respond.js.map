{"version":3,"sources":["routes/respond.ts"],"names":[],"mappings":"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","file":"routes/respond.js","sourcesContent":["import express = require('express');\r\nimport passport = require('passport');\r\nvar router = express.Router();\r\n\r\n\r\n//variable declaration\r\nvar surveyname,surveytype,mcqrespond,agreerespond,displayname,fromadds;\r\n// db references\r\nimport mongoose = require('mongoose');\r\nimport mcqModel = require('../models/multiple');\r\nimport agreeModel = require('../models/agree');\r\nimport respondModel = require('../models/respond');\r\n\r\nimport Mcq = mcqModel.Mcq;\r\nimport Agree = agreeModel.Agree;\r\nimport Respond = respondModel.Respond;\r\n/* Utility Function to check if user is authenticated */\r\nfunction requireAuth(req:express.Request, res:express.Response, next: any) {\r\n    // check if the user is logged in\r\n    if (!req.isAuthenticated()) {\r\n        return res.redirect('/login');\r\n    }\r\n    next();\r\n}\r\n\r\n\r\nrouter.get('/presend', requireAuth, (req: express.Request, res: express.Response, next: any) => {\r\n      var ss=req.query;\r\n    /*  var sendgrid = require(\"sendgrid\")(\"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\");\r\nvar email = new sendgrid.Email();\r\n\r\nemail.addTo(\"patelritesh261@gmail.com\");\r\nemail.setFrom(\"patelritesh261@gmail.com\");\r\nemail.setSubject(\"Sending with SendGrid is Fun\");\r\nemail.setHtml(\"<html><body><main><h2>HI There,</main><h4>Please do following survey and give your feedback</h4><table><tr><td>Survey Name : </td><td>\"+ss.surveyName+\"</td></tr><tr><td>Created By : </td><td>\"+ss.displayName+\"</td></tr><tr><td colspan=2><a href=\"+\"/respond/\"+ss.displayName+\"/\"+ss.surveyType+\"/\"+ss.surveyName+\" >Give feedback</a></td></tr></table></body></html>\");\r\n//email.setHtml(\"/respond/\"+ss.displayName+\"/\"+ss.surveyType+\"/\"+ss.surveyName);\r\n\r\n\r\nsendgrid.send(email);*/\r\n// res.send(ss);\r\n      res.redirect('/respond/'+ss.displayName+'/'+ss.surveyType+'/'+ss.surveyName+'/'+ss.fromadd);\r\n\r\n    //res.render('multiple/text');\r\n});\r\nrouter.post('/presend', requireAuth, (req: express.Request, res: express.Response, next: any) => {\r\n    var noq=req.body.length;\r\n    \r\n    var qanswer=\"\";\r\n   \r\nfor(var i=0;i<req.body.length;i++){\r\n    if(i==0)\r\n    {\r\n        \r\n        qanswer=req.body.answer0;\r\n    }\r\n    else if(i==1)\r\n    {\r\n        \r\n        qanswer=req.body.answer1;\r\n    }\r\n    else if(i==2)\r\n    {\r\n        \r\n        qanswer=req.body.answer2;\r\n    }\r\n    else if(i==3)\r\n    {\r\n        \r\n        qanswer=req.body.answer3;\r\n    }\r\n    else if(i==4)\r\n    {\r\n        \r\n        qanswer=req.body.answer4;\r\n    }\r\n    else if(i==5)\r\n    {\r\n        \r\n        qanswer=req.body.answer5;\r\n    }\r\n    else if(i==6)\r\n    {\r\n        \r\n        qanswer=req.body.answer6;\r\n    }\r\n    else if(i==7)\r\n    {\r\n        \r\n        qanswer=req.body.answer7;\r\n    }\r\n    else if(i==8)\r\n    {\r\n        \r\n        qanswer=req.body.answer8;\r\n    }\r\n    else if(i==9)\r\n    {\r\n        \r\n        qanswer=req.body.answer9;\r\n    }\r\n    else if(i==10)\r\n    {\r\n        \r\n        qanswer=req.body.answer10;\r\n    }\r\n   // res.send(qanswer);\r\n Respond.create({\r\n        question: req.body.question[i],\r\n       answer:qanswer,\r\n        senderName: req.body.displayName,\r\n        receiverName: req.body.fromadd,\r\n        surveyName: req.body.surveyName,\r\n    }, function(error, Respond) {\r\n        // did we get back an error or valid Article object?\r\n        if (error) {\r\n            console.log(error);\r\n            res.end(error);\r\n        }\r\n        else {\r\n           \r\n           // res.redirect('/multiple/add');\r\n        }\r\n    });\r\n    qanswer=\"\";\r\n}\r\n    res.redirect('/respond/thankyou');\r\n});\r\nrouter.get('/:displayName/:surveyType/:surveyName/:fromadd', (req: express.Request, res: express.Response, next: any) => {\r\n    surveytype=req.params.surveyType;\r\n      displayname=req.params.displayName;\r\n       surveyname=req.params.surveyName;\r\n       fromadds=req.params.fromadd;\r\n     if(surveytype==\"multiple\"){\r\n    // use the Users model to query the Users collection \r\n   Mcq.find({displayName:displayname,surveyName:surveyname},{},(error, mcq) => {\r\n        if (error) {\r\n            console.log(error);\r\n            res.end(error);\r\n        }\r\n        else {\r\n            // no error, we found a list of users\r\n            mcqrespond=mcq;\r\n            res.redirect('/respond/feedbackmcq');\r\n        }\r\n    });\r\n}else if(surveytype==\"agree\"){\r\n    Agree.find({displayName:displayname,surveyName:surveyname},{},(error, agree) => {\r\n        if (error) {\r\n            console.log(error);\r\n            res.end(error);\r\n        }\r\n        else {\r\n            // no error, we found a list of users\r\n            agreerespond=agree;\r\n            res.redirect('/respond/feedbackagree');\r\n        }\r\n    });\r\n    \r\n}\r\n    //res.render('multiple/text');\r\n});\r\n\r\nrouter.get('/feedbackmcq', (req: express.Request, res: express.Response, next: any) => {\r\n      res.render('respond/feedbackmcq',{\r\n          title:'Feedback',\r\n          mcq:mcqrespond,\r\n          surveyname:surveyname,\r\n          displayName:displayname,\r\n          fromadd:fromadds\r\n      });\r\n});\r\nrouter.get('/feedbackagree', (req: express.Request, res: express.Response, next: any) => {\r\n      res.render('respond/feedbackagree',{\r\n          title:'Feedback',\r\n          agree:agreerespond,\r\n          surveyname:surveyname,\r\n          displayName:displayname,\r\n          fromadd:fromadds\r\n      });\r\n});\r\nrouter.get('/presurveyreport', (req: express.Request, res: express.Response, next: any) => {\r\n    \r\n      res.render('respond/feedbackagree',{\r\n          title:'Feedback',\r\n          agree:agreerespond,\r\n          surveyname:surveyname,\r\n          displayName:displayname,\r\n          fromadd:fromadds\r\n      });\r\n});\r\nrouter.post('/presurveyreport', (req: express.Request, res: express.Response, next: any) => {\r\n   var ss=req.body.surveyName;\r\n                var ds=req.body.displayName;\r\n                var rn=req.body.recieverName;\r\n              \r\n Respond.find({senderName:ds,surveyName:ss,receiverName:rn},{},(error, respond) => {\r\n                    if (error) {\r\n                        console.log(error);\r\n                        res.end(error);\r\n                    }\r\n                    else {\r\n                            \r\n                            // no error, we found a list of users\r\n                                res.render('respond/surveyreport', {\r\n                                title: 'Survey Report',\r\n                                recieverName:rn,\r\n                               surveyname:ss,\r\n                                respond:respond,\r\n                                displayName: req.user ? req.user.displayName : ''\r\n            });\r\n        }\r\n    });\r\n});\r\nrouter.get('/thankyou', (req: express.Request, res: express.Response, next: any) => {\r\n    \r\n                               \r\n     res.render('respond/thankyou',{\r\n          title:'Thank you',\r\n          displayName:displayname,\r\n         \r\n      });\r\n});\r\n// make this public\r\nmodule.exports = router;"],"sourceRoot":"/source/"}